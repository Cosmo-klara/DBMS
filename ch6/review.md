# 数据库安全性

任何系统的安全措施都不是绝对可靠的

> 数据库系统的安全保护措施是否有效是数据库系统主要的性能指标之一

+ 数据库安全性是**指保护数据库不被非法使用和防止非法用户恶意造成的破坏**

    > 安全性措施的防范对象是**非法用户的进入和合法用户的非法操作**

+ 数据库完整性是**保护数据库以防止合法用户无意造成的破坏**
    > 完整性措施主要**防范不合语义的数据进入数据库**

## 计算机安全性概述

### 安全等级: 

|安全级别|定义|
|:---:|:---:|
|A1|验证设计（Verified Design）|
|B3|安全域（Security Domains）|
|B2|结构化保护（Structural Protection）|
|B1|标记安全保护(Labeled Security Protection)|
|C2|受控的存取保护(Controlled Access Protection)|
|C1|自主安全保护(Discretionary Security Protection)|
|D|最小保护（Minimal Protection）|

+ DOS是安全标准为D的操作系统

+ C1级: 非常初级的自主安全保护, 能够实现对**用户和数据的分离**，进行**自主存取控制(DAC)**，保护或限制用户权限的传播。

+ C2级: 安全产品的最低档次, 提供**受控的存取保护**，将C1级的DAC进一步细化，以个人身份注册负责，并实施**审计和资源隔离**

+ B1级: 标记安全保护。对系统的数据加以标记，对标记的主体和客体实施**强制存取控制(MAC)、审计**等安全机制


### 安全性概念

+ 数据库的安全性是**指保护数据库，防止因用户非法使用数据库造成数据泄露、更改或破坏**,在数据库应用系统的不同层次提供安全防范措施,保护数据不受恶意访问

    > 目标是保证数据的完整性, 可用性, 保密性和审计性

    + 数据的完整性是指数据的正确性,一致性和相容性

    + 数据的可用性是指合法用户申请存取数据时,系统采用的安全机制不能明显降低数据库系统的性能

    + 数据的保密性是指系统能提供对数据库中的机密数据进行加密,防止非法用户窃听明文信息

    + 数据的可审计性是指提供审计功能,把合法用户对数据库所做的操作记录在审计数据库中,使其具有不可否认性

+ 数据保密是指**用户合法地访问到机密数据后能否对这些数据保密**

## 安全技术

**数据库的安全性涉及数据库的安全机制，也涉及到硬件系统、操作系统、网络系统的安全机制**

数据库系统采用的安全技术主要为:

+ **用户标识与鉴别**：该方法由系统提供一定的方式让用户标识自己的名字或身份。用户进入系统时，由系统进行核对，通过鉴定后才提供系统的使用权
    > 最外层的安全保护措施

+ **存取控制技术**：通过用户权限定义和合法权检查确保只有合法权限的用户访问数据库，所有未被授权的人员无法存取数据

+ **视图机制**：为不同的用户定义视图，通过视图机制把要保密的数据对无权存取的用户隐藏起来，从而自动地对数据提供一定程度的安全保护

+ **数据加密技术**：用于保护敏感数据的传输和存储，可以对数据库的敏感数据提供额外的保护

+ **数据库审计**：审计是在数据库系统运行期间，记录数据库的访问情况，以利用审计数据分析数据库是否受到非法存取

### 存取控制技术

存取控制机制的组成: **定义用户权限和合法权限检查**

> 用户权限定义和合法权限检查机制一起组成了DBMS的安全子系统。

#### 自主存取控制（Discretionary Access Control ,DAC）

> **C2级、灵活, 在自主访问控制中，访问控制的实施由系统完成**

+ 同一用户对于不同的数据对象有不同的存取权限
+ 不同的用户对同一对象也有不同的权限
+ 用户还可将其拥有的存取权限转授给其他用户

#### 强制存取控制（Mandatory Access Control, MAC）

> **B1级、严格, MAC不是用户能直接感知或进行控制的**

+ 每一个数据对象被标以一定的密级
+ 每一个用户也被授予某一个级别的许可证
+ 对于任意一个对象，只有具有合法许可证的用户才可以存取

## 自主存取控制

### 基本概念

+ **主体（Subject）是指一个提出请求或要求的实体**，主体可以是DBMS所管理的实际用户，或其它任何代表用户行为的进程、作业和程序

+ **客体（Object）是接受其他实体访问的被动实体**，是受主体操纵，客体可以是文件、记录、视图等

+ **控制策略是主体对客体的操作行为集和约束条件集，即主体对客体的访问规则集**

+ **访问控制矩阵**: 在自主存取控制模型中，主体、客体和控制策略构成了一个矩阵，矩阵的列标识主体，矩阵的行表示客体, 矩阵中的元素是控制策略(如读、写、删除和修改等)

+ 通过 SQL 的 GRANT 语句和 REVOKE 语句实现

+ 角色: 被命名的一组与数据库操作相关的权限, 是权限的集合

### 用户权限

由**数据对象和操作类型**组成

+ 定义存取权限称为授权: 定义用户可以在哪些数据库对象上进行哪些类型的操作

授权粒度是指**可以定义的数据对象的范围**

+ 是衡量授权机制是否灵活的一个重要指标。

+ 授权定义中数据对象的粒度越细，即可以定义的数据对象的范围越小，授权子系统就越灵活 ，但
系统定义与权限检查的开销将增加。

    > 关系数据库中授权的数据对象粒度: 数据库、表、属性列、 

### 优点：

能够通过授权机制有效地控制其他用户对敏感数据的存取

### 缺点：

由于存取权限是“自主”的，权限可以传播，接受授权的用户就可以“非法”传播数据，可能存在数据的“无意泄露”

原因：这种机制仅仅通过对数据的存取权限来进行安全控制，而**数据本身并无安全性标记**

解决：对系统控制下的所有主客体实施**强制存取控制**策略

## 强制存取控制

强制存取控制(MAC)是指系统为保证更高程度的安全性，按照TDI/TCSEC标准中安全策略的要求，所采取的强制存取检查手段。

> MAC不是用户能直接感知或进行控制的

### 强制存取控制策略

在安全级别基础上对数据或用户进行分类，通过对主体和客体的已分配的安全属性进行匹配判断,决定主体是否有权对客体进行进一步的访问操作

+ 主体和客体被标记成不同的安全分类级别
    > 绝密-TS（Top Secret）、机密-S（Secret）、可信-C（Confidential）和公开（Public）。

    主体的敏感度标记称为**许可证级别**(Clearance Level)
    
    客体的敏感度标记称为**密级**(Classification Level)

+ MAC机制就是通过对比主体的安全级别和客体的安全级别，最终确定主体能否存取客体

### 强制存取控制规则：

+ 仅当主体的许可证级别**大于或等于**客体的密级时，该主体才能**读取**相应的客体；许可证级别低的主体不能读取安全级别比他高的客体

+ 仅当主体的许可证级别**等于**客体的密级时，该主体才能**写**相应的客体
    > 如果违反这个规则，那么就将允许信息从较高的安全级别流向较低的安全级别，这就违反了多级安全性的基本原则

## 加密方法

+ 替换方法
+ 置换方法
+ 混合方法

## 审计

> 预防检测技术

C2以上安全级别的DBMS必须具有

审计分为

+ **用户级审计**
    > 针对自己创建的数据库表或视图进行审计
    
    记录所有用户对这些表或视图的一切成功和(或)不成功的访问要求以及各种类型的SQL操作
+ **系统级审计**
    > DBA设置

    监测成功或失败的登录要求, 监测GRANT和REVOKE操作以及其他数据库级权限下的操作

## 